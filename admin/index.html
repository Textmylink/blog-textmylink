<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TextMyLink CMS</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script>
      (function () {
        function bindIdentity(identity) {
          identity.on("init", function (user) {
            if (!user) {
              identity.on("login", function () {
                document.location.reload();
              });
              identity.open("login");
            }
          });

          identity.on("logout", function () {
            document.location.reload();
          });
        }

        function waitForIdentity(retries) {
          if (window.netlifyIdentity) {
            bindIdentity(window.netlifyIdentity);
            return;
          }

          if (retries <= 0) {
            console.error("Netlify Identity failed to load");
            return;
          }

          window.setTimeout(function () {
            waitForIdentity(retries - 1);
          }, 250);
        }

        waitForIdentity(40);
      })();
    </script>
  </head>
  <body>
    <div id="nc-root"></div>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
  </body>
</html>
